"use strict";function byId(e){return document.getElementById(e)}const DOM={nav:{menuBtn:byId("menu-btn"),settingsBtn:byId("settings-btn"),newGameBtn:byId("newgame-btn"),mineCounter:document.querySelector("#mine-counter > span"),timer:{minutes:byId("timer-minutes"),seconds:byId("timer-seconds")},hintBtn:byId("hint-btn"),mineBtn:byId("mine-btn"),markBtn:byId("mark-btn")},playarea:{columnNums:byId("column-nums"),rowNums:byId("row-nums"),board:{tiles:null,container:byId("board")},winOverlay:{container:byId("win-overlay"),time:byId("win-time"),newBestTime:byId("new-best-time"),newGameBtn:byId("win-new-game-btn"),viewBoardBtn:byId("win-view-board-btn")},loseOverlay:{container:byId("lose-overlay"),minesLeft:byId("lose-mines-left"),newGameBtn:byId("lose-new-game-btn"),viewBoardBtn:byId("lose-view-board-btn")}},modals:{container:byId("modals"),menu:{container:byId("menu-modal"),btns:byId("menu-modal-btns")},settings:{container:byId("settings-modal"),boardSize:byId("settings-boardSize"),customBoard:{container:byId("settings-customBoard"),rows:byId("settings-boardHeight"),columns:byId("settings-boardWidth"),numOfMines:byId("settings-mineNum"),maxMines:byId("settings-maxMines")},boardApplyWarning:byId("settings-applywarning"),tileSize:byId("settings-tileSize"),theme:byId("settings-theme")},statistics:{select:byId("stats-select"),gamesPlayed:byId("stats-gamesplayed"),gamesWon:byId("stats-gameswon"),gamesLost:byId("stats-gameslost"),winPercent:byId("stats-winpercent"),bestTime:byId("stats-besttime"),longestWinningStreak:byId("stats-longestwinstreak"),longestLosingStreak:byId("stats-longestlosestreak"),currentStreak:byId("stats-currentstreak")},newGameWarning:{container:byId("newgamewarning-modal"),confirm:byId("newgamewarning-confirm")}}};let board=[];class Tile{uncovered=!1;hasMine=!1;numOfNearbyMines=0;markedAsEmpty=!1}const gameVars={state:"initial",minesLeft:20,hints:1,hintMode:!1,markMode:"none",clickSwap:!1,timeStart:null,board:{rows:10,columns:10,numOfMines:20},clockInterval:null,boardSize:"small",rowMineCount:[],columnMineCount:[]};let settings={board:{rows:10,columns:10,numOfMines:20},boardSize:"small",maxMines:50,tileSize:32,theme:"auto"};const boardSizes={small:{rows:10,columns:10,numOfMines:20},medium:{rows:15,columns:15,numOfMines:50},large:{rows:20,columns:20,numOfMines:90},veryLarge:{rows:30,columns:30,numOfMines:200}};let statistics={small:{gamesWon:0,gamesLost:0,bestTime:null,longestWinningStreak:0,longestLosingStreak:0,currentStreak:0,streakMode:"N/A"},medium:{gamesWon:0,gamesLost:0,bestTime:null,longestWinningStreak:0,longestLosingStreak:0,currentStreak:0,streakMode:"N/A"},large:{gamesWon:0,gamesLost:0,bestTime:null,longestWinningStreak:0,longestLosingStreak:0,currentStreak:0,streakMode:"N/A"},veryLarge:{gamesWon:0,gamesLost:0,bestTime:null,longestWinningStreak:0,longestLosingStreak:0,currentStreak:0,streakMode:"N/A"},custom:{gamesWon:0,gamesLost:0,longestWinningStreak:0,longestLosingStreak:0,currentStreak:0,streakMode:"N/A"}};function createEmptyBoard(){board=[];for(let e=0;e<gameVars.board.rows;e++){board[e]=[];for(let a=0;a<gameVars.board.columns;a++)board[e][a]=new Tile}}function populateBoardWithMines(e,a,t){let s=[];for(let e=0;e<gameVars.board.rows;e++)for(let a=0;a<gameVars.board.columns;a++)s.push({row:e,column:a});gameVars.rowMineCount=new Array(gameVars.board.rows).fill(0),gameVars.columnMineCount=new Array(gameVars.board.columns).fill(0);let n=s.findIndex((t=>t.row==e&&t.column==a));-1!=n&&s.splice(n,1),board[e][a].hasMine=!0;for(let e=1;e<t;e++){let e=Math.floor(Math.random()*s.length);board[s[e].row][s[e].column].hasMine=!0,s.splice(e,1)}for(let e=0;e<board.length;e++)for(let a=0;a<board[e].length;a++)countNearbyMines(parseInt(e),parseInt(a)),board[e][a].hasMine&&(gameVars.rowMineCount[e]++,gameVars.columnMineCount[a]++)}function checkIfTileHasMine(e,a){return e<0||e>=gameVars.board.rows||a<0||a>=gameVars.board.columns||!board[e][a].hasMine?0:1}function countNearbyMines(e,a){let t=0;for(let s=-1;s<=1;s++)for(let n=-1;n<=1;n++)0==s&&0==n||(t+=checkIfTileHasMine(e+s,a+n));board[e][a].numOfNearbyMines=t}function getTileElement(e,a){return DOM.playarea.board.container.querySelector(`[data-row="${e}"][data-column="${a}"]`)}function tileClick(e,a){"initial"==gameVars.state?(gameVars.state="underway",populateBoardWithMines(e,a,gameVars.board.numOfMines),displayBorderNums(),gameVars.clockInterval=setInterval((()=>{let e=Date.now()-gameVars.timeStart,a=Math.floor(e/1e3),t=Math.floor(a/60),s=a%60;DOM.nav.timer.minutes.innerHTML=t<=9?`0${t}`:t,DOM.nav.timer.seconds.innerHTML=s<=9?`0${s}`:s}),200),gameVars.timeStart=Date.now(),uncoverTile(e,a),DOM.nav.mineCounter.innerHTML=gameVars.minesLeft,gameVars.xyzzyActivated&&xyzzyInit()):"underway"==gameVars.state&&(1==gameVars.hintMode?(uncoverTile(e,a,!0),gameVars.hints-=1,DOM.nav.hintBtn.dataset.hints=gameVars.hints,gameVars.hints<=0&&(DOM.nav.hintBtn.classList.remove("hint-active"),DOM.nav.hintBtn.classList.add("hint-disabled"),gameVars.hintMode=!1)):uncoverTile(e,a),DOM.nav.mineCounter.innerHTML=gameVars.minesLeft)}function tileMark(e,a){"underway"!=gameVars.state||board[e][a].uncovered||(board[e][a].markedAsEmpty?("none"==gameVars.markMode&&(gameVars.markMode="remove"),"remove"==gameVars.markMode&&(board[e][a].markedAsEmpty=!1,getTileElement(e,a).innerHTML="")):("none"==gameVars.markMode&&(gameVars.markMode="mark"),"mark"==gameVars.markMode&&(board[e][a].markedAsEmpty=!0,getTileElement(e,a).innerHTML='<i class="icon-flag"></i>')))}function uncoverTile(e,a,t=!1,s=!1){if("underway"!=gameVars.state&&!s||e<0||e>=gameVars.board.rows||a<0||a>=gameVars.board.columns||board[e][a].uncovered)return null;if(board[e][a].hasMine&&!board[e][a].markedAsEmpty){getTileElement(e,a).innerHTML="<i class='icon-mine'></i>",getTileElement(e,a).dataset.clickable="false",board[e][a].uncovered=!0;for(let t=-1;t<=1;t++)for(let n=-1;n<=1;n++)0==t&&0==n||uncoverTile(e+t,a+n,!0,s);gameVars.minesLeft--,0==gameVars.minesLeft&&"underway"==gameVars.state&&winGame()}else t?(board[e][a].uncovered=!0,board[e][a].markedAsEmpty=!1,getTileElement(e,a).innerHTML=board[e][a].numOfNearbyMines,getTileElement(e,a).dataset.clickable="false"):board[e][a].markedAsEmpty||"underway"!=gameVars.state||(getTileElement(e,a).classList.add("wrong-tile"),loseGame())}function winGame(){let e=Date.now()-gameVars.timeStart,a=Math.floor(e/1e3),t=Math.floor(a/60),s=a%60,n=e%1e3;t<=9&&(t=`0${t}`),s<=9&&(s=`0${s}`),n<=100&&(n=`${"0".repeat(3-n.toString().length)}${n}`),DOM.playarea.winOverlay.time.innerHTML=`${t}:${s}.${n}`,statistics[gameVars.boardSize].gamesWon++,"winning"!=statistics[gameVars.boardSize].streakMode?(statistics[gameVars.boardSize].currentStreak=1,statistics[gameVars.boardSize].streakMode="winning"):statistics[gameVars.boardSize].currentStreak++,statistics[gameVars.boardSize].currentStreak>statistics[gameVars.boardSize].longestWinningStreak&&(statistics[gameVars.boardSize].longestWinningStreak=statistics[gameVars.boardSize].currentStreak),e<=statistics[gameVars.boardSize].bestTime||null===statistics[gameVars.boardSize].bestTime?(statistics[gameVars.boardSize].bestTime=e,DOM.playarea.winOverlay.newBestTime.style.display="block"):DOM.playarea.winOverlay.newBestTime.style.display="NONE",localStorage.setItem("sweeperofmines-statistics",JSON.stringify(statistics)),DOM.playarea.winOverlay.container.classList.remove("fade"),DOM.playarea.winOverlay.container.classList.add("visible"),DOM.playarea.board.container.classList.add("no-input"),gameVars.state="finished",clearInterval(gameVars.clockInterval)}function loseGame(){statistics[gameVars.boardSize].gamesLost++,"losing"!=statistics[gameVars.boardSize].streakMode?(statistics[gameVars.boardSize].currentStreak=1,statistics[gameVars.boardSize].streakMode="losing"):statistics[gameVars.boardSize].currentStreak++,statistics[gameVars.boardSize].currentStreak>statistics[gameVars.boardSize].longestLosingStreak&&(statistics[gameVars.boardSize].longestLosingStreak=statistics[gameVars.boardSize].currentStreak),localStorage.setItem("sweeperofmines-statistics",JSON.stringify(statistics)),DOM.playarea.loseOverlay.minesLeft.innerHTML=gameVars.minesLeft,DOM.playarea.loseOverlay.container.classList.remove("fade"),DOM.playarea.loseOverlay.container.classList.add("visible"),DOM.playarea.board.container.classList.add("no-input"),gameVars.state="finished",clearInterval(gameVars.clockInterval)}function uncoverBoard(){for(let e=0;e<board.length;e++)for(let a=0;a<board[e].length;a++)board[e][a].hasMine?(getTileElement(e,a).innerHTML="<i class='icon-mine'></i>",getTileElement(e,a).dataset.clickable="false"):getTileElement(e,a).innerHTML=board[e][a].numOfNearbyMines}function displayEmptyBorderNums(){let e="";for(let a=0;a<gameVars.board.rows;a++)e+="<div>#</div>";DOM.playarea.rowNums.innerHTML=e,e="";for(let a=0;a<gameVars.board.columns;a++)e+="<div>#</div>";DOM.playarea.columnNums.innerHTML=e}function displayBorderNums(){let e="";for(let a of gameVars.rowMineCount)e+=`<div>${a}</div>`;DOM.playarea.rowNums.innerHTML=e,e="";for(let a of gameVars.columnMineCount)e+=`<div>${a}</div>`;DOM.playarea.columnNums.innerHTML=e}function showStats(e){if(DOM.modals.statistics.gamesPlayed.innerHTML=statistics[e].gamesWon+statistics[e].gamesLost,DOM.modals.statistics.gamesWon.innerHTML=statistics[e].gamesWon,DOM.modals.statistics.gamesLost.innerHTML=statistics[e].gamesLost,statistics[e].gamesWon+statistics[e].gamesLost!=0){let a=statistics[e].gamesWon/(statistics[e].gamesWon+statistics[e].gamesLost)*100;DOM.modals.statistics.winPercent.innerHTML=`${a.toFixed(2)}%`}else DOM.modals.statistics.winPercent.innerHTML="N/A";if(DOM.modals.statistics.longestWinningStreak.innerHTML=statistics[e].longestWinningStreak,DOM.modals.statistics.longestLosingStreak.innerHTML=statistics[e].longestLosingStreak,DOM.modals.statistics.currentStreak.innerHTML=`${statistics[e].currentStreak} (${statistics[e].streakMode})`,"custom"!=e){if(null!=statistics[e].bestTime){let a=Math.floor(statistics[e].bestTime/1e3/60),t=Math.floor(statistics[e].bestTime/1e3%60),s=statistics[e].bestTime%1e3;DOM.modals.statistics.bestTime.innerHTML=`${a}:${t}.${s}`}else DOM.modals.statistics.bestTime.innerHTML="N/A";DOM.modals.statistics.bestTime.parentNode.style.removeProperty("display")}else DOM.modals.statistics.bestTime.parentNode.style.display="none"}let multiTouch=!1,markTouch=!1;function displayBoard(){let e="";for(let a=0;a<board.length;a++){e+="<div>";for(let t=0;t<board[a].length;t++)e+=`<div data-row="${a}" data-column="${t}"></div>`;e+="</div>"}DOM.playarea.board.container.innerHTML=e,DOM.playarea.board.tiles=document.querySelectorAll("[data-row][data-column]");for(let e of DOM.playarea.board.tiles)e.addEventListener("pointerdown",(a=>{a.isPrimary&&!multiTouch?((2==a.button||gameVars.clickSwap)&&(markTouch=!0,tileMark(parseInt(e.dataset.row),parseInt(e.dataset.column))),a.target.releasePointerCapture(a.pointerId)):multiTouch=!0})),e.addEventListener("pointerup",(a=>{a.isPrimary&&(a.isPrimary&&multiTouch?multiTouch=!1:(markTouch=!1,gameVars.clickSwap||0!=a.button||tileClick(parseInt(e.dataset.row),parseInt(e.dataset.column))))})),e.addEventListener("contextmenu",(e=>(e.preventDefault(),!1))),e.addEventListener("pointerenter",(a=>{a.isPrimary&&(markTouch||2==a.buttons)&&tileMark(parseInt(e.dataset.row),parseInt(e.dataset.column))})),e.addEventListener("pointercancel",(e=>{markTouch=!1,gameVars.markMode="none"}))}function newGame(){gameVars.boardSize=settings.boardSize,"custom"!=settings.boardSize?Object.assign(gameVars.board,boardSizes[gameVars.boardSize]):Object.assign(gameVars.board,settings.board),DOM.modals.settings.boardApplyWarning.style.removeProperty("display"),gameVars.hints=1+Math.floor(gameVars.board.columns*gameVars.board.rows/400),gameVars.hintMode=!1,DOM.nav.hintBtn.dataset.hints=gameVars.hints,DOM.nav.hintBtn.classList.remove("hint-active"),DOM.nav.hintBtn.classList.remove("hint-disabled"),createEmptyBoard(),displayBoard(),displayEmptyBorderNums(),gameVars.state="initial",clearInterval(gameVars.clockInterval),DOM.nav.timer.minutes.innerHTML=DOM.nav.timer.seconds.innerHTML="00",DOM.playarea.board.container.classList.remove("no-input"),DOM.nav.mineCounter.innerHTML=gameVars.minesLeft=gameVars.board.numOfMines}document.body.addEventListener("pointerup",(()=>{markTouch=!1,gameVars.markMode="none"})),DOM.nav.mineBtn.addEventListener("click",(()=>{gameVars.clickSwap=!1,DOM.playarea.board.container.classList.remove("no-scroll"),DOM.nav.mineBtn.classList.add("active"),DOM.nav.markBtn.classList.remove("active")})),DOM.nav.markBtn.addEventListener("click",(()=>{gameVars.clickSwap=!0,DOM.playarea.board.container.classList.add("no-scroll"),DOM.nav.markBtn.classList.add("active"),DOM.nav.mineBtn.classList.remove("active")})),DOM.nav.newGameBtn.addEventListener("click",(e=>{"underway"===gameVars.state?(DOM.modals.container.classList.add("visible"),DOM.modals.container.classList.remove("fade"),DOM.modals.newGameWarning.container.classList.add("visible"),DOM.modals.newGameWarning.container.classList.remove("fade")):newGame()})),DOM.modals.newGameWarning.confirm.addEventListener("click",(e=>{statistics[gameVars.boardSize].gamesLost++,"losing"!=statistics[gameVars.boardSize].streakMode?(statistics[gameVars.boardSize].currentStreak=1,statistics[gameVars.boardSize].streakMode="losing"):statistics[gameVars.boardSize].currentStreak++,statistics[gameVars.boardSize].currentStreak>statistics[gameVars.boardSize].longestLosingStreak&&(statistics[gameVars.boardSize].longestLosingStreak=statistics[gameVars.boardSize].currentStreak),localStorage.setItem("sweeperofmines-statistics",JSON.stringify(statistics)),newGame()})),DOM.nav.hintBtn.addEventListener("click",(()=>{gameVars.hints>=1&&(DOM.nav.hintBtn.classList.toggle("hint-active"),gameVars.hintMode=!gameVars.hintMode)})),document.querySelectorAll("[data-modalopen]").forEach((e=>{e.addEventListener("click",(()=>{DOM.modals.container.classList.add("visible"),DOM.modals.container.classList.remove("fade"),document.querySelector(e.dataset.modalopen).classList.add("visible"),document.querySelector(e.dataset.modalopen).classList.remove("fade")}))})),document.querySelectorAll(".modal-close").forEach((e=>{e.addEventListener("click",(()=>{DOM.modals.container.classList.add("fade"),DOM.modals.container.classList.remove("visible"),e.parentNode.parentNode.classList.add("fade"),e.parentNode.parentNode.classList.remove("visible")}))})),document.querySelectorAll('[data-modalopen="#statistics-modal"]').forEach((e=>{e.addEventListener("click",(()=>{showStats(DOM.modals.statistics.select.value)}))})),DOM.modals.settings.container.addEventListener("click",(()=>{localStorage.setItem("sweeperofmines-settings",JSON.stringify(settings)),"underway"!=gameVars.state&&newGame()})),DOM.modals.settings.container.querySelector(".modal-close").addEventListener("click",(()=>{localStorage.setItem("sweeperofmines-settings",JSON.stringify(settings)),"underway"!=gameVars.state&&newGame()})),document.querySelectorAll(".modal").forEach((e=>{e.addEventListener("click",(a=>{a.target===a.currentTarget&&(DOM.modals.settings.container.classList.contains("visible")&&localStorage.setItem("sweeperofmines-settings",JSON.stringify(settings)),DOM.modals.container.classList.add("fade"),DOM.modals.container.classList.remove("visible"),e.classList.add("fade"),e.classList.remove("visible"))}))})),DOM.modals.settings.container.addEventListener("click",(()=>{"underway"!=gameVars.state&&newGame()})),DOM.modals.menu.btns.querySelectorAll("button").forEach((e=>{e.addEventListener("click",(()=>{DOM.modals.menu.container.classList.add("fade"),DOM.modals.menu.container.classList.remove("visible")}))})),DOM.playarea.board.container.addEventListener("scroll",(()=>{DOM.playarea.rowNums.scroll(0,DOM.playarea.board.container.scrollTop),DOM.playarea.columnNums.scroll(DOM.playarea.board.container.scrollLeft,0)}),{passive:!0}),DOM.playarea.winOverlay.newGameBtn.addEventListener("click",(()=>{newGame(),DOM.playarea.winOverlay.container.classList.add("fade"),DOM.playarea.winOverlay.container.classList.remove("visible")})),DOM.playarea.winOverlay.viewBoardBtn.addEventListener("click",(()=>{DOM.playarea.winOverlay.container.classList.add("fade"),DOM.playarea.winOverlay.container.classList.remove("visible")})),DOM.playarea.loseOverlay.newGameBtn.addEventListener("click",(()=>{newGame(),DOM.playarea.loseOverlay.container.classList.add("fade"),DOM.playarea.loseOverlay.container.classList.remove("visible")})),DOM.playarea.loseOverlay.viewBoardBtn.addEventListener("click",(()=>{DOM.playarea.loseOverlay.container.classList.add("fade"),DOM.playarea.loseOverlay.container.classList.remove("visible"),uncoverBoard()})),DOM.modals.settings.boardSize.addEventListener("change",(e=>{settings.boardSize=e.target.value,"underway"==gameVars.state&&(DOM.modals.settings.boardApplyWarning.style.display="block")}));const numbersOnlyRegex=/^[0-9]+$/g;function calculateMaxMines(){let e=Math.floor(settings.board.columns*settings.board.rows/2);e<12&&(e=12),DOM.modals.settings.customBoard.maxMines.innerHTML=settings.maxMines=e,DOM.modals.settings.customBoard.numOfMines.value>settings.maxMines&&(DOM.modals.settings.customBoard.numOfMines.value=settings.maxMines),settings.board.numOfMines=parseInt(DOM.modals.settings.customBoard.numOfMines.value)}DOM.modals.settings.customBoard.columns.addEventListener("input",(e=>{e.target.value=e.target.value.match(numbersOnlyRegex),e.target.value?e.target.value>100&&!customBoardUnlimited?(e.target.value=100,settings.board.columns=parseInt(e.target.value)):settings.board.columns=parseInt(e.target.value):settings.board.columns=5,calculateMaxMines(),"underway"==gameVars.state&&(DOM.modals.settings.boardApplyWarning.style.display="block")})),DOM.modals.settings.customBoard.columns.addEventListener("blur",(e=>{!e.target.value||e.target.value<5?e.target.value=5:e.target.value>100&&!customBoardUnlimited&&(e.target.value=100),settings.board.columns=parseInt(e.target.value),calculateMaxMines(),"underway"==gameVars.state&&(DOM.modals.settings.boardApplyWarning.style.display="block")})),DOM.modals.settings.customBoard.rows.addEventListener("input",(e=>{e.target.value=e.target.value.match(numbersOnlyRegex),""==e.target.value?settings.board.rows=5:e.target.value>100&&!customBoardUnlimited?(e.target.value=100,settings.board.rows=parseInt(e.target.value)):settings.board.rows=parseInt(e.target.value),calculateMaxMines(),"underway"==gameVars.state&&(DOM.modals.settings.boardApplyWarning.style.display="block")})),DOM.modals.settings.customBoard.rows.addEventListener("blur",(e=>{""==e.target.value||e.target.value<5?e.target.value=5:e.target.value>100&&!customBoardUnlimited&&(e.target.value=100),settings.board.rows=parseInt(e.target.value),calculateMaxMines(),"underway"==gameVars.state&&(DOM.modals.settings.boardApplyWarning.style.display="block")})),DOM.modals.settings.customBoard.numOfMines.addEventListener("input",(e=>{e.target.value>settings.maxMines&&(e.target.value=settings.maxMines),settings.board.numOfMines=parseInt(e.target.value),"underway"==gameVars.state?DOM.modals.settings.boardApplyWarning.style.display="block":gameVars.board.numOfMines=parseInt(e.target.value)})),DOM.modals.settings.customBoard.numOfMines.addEventListener("blur",(e=>{(e.target.value<2||!e.target.value)&&(e.target.value=2),settings.board.numOfMines=parseInt(e.target.value),"underway"==gameVars.state?DOM.modals.settings.boardApplyWarning.style.display="block":gameVars.board.numOfMines=parseInt(e.target.value)})),DOM.modals.statistics.select.addEventListener("change",(e=>{showStats(e.target.value)})),DOM.modals.settings.boardSize.addEventListener("change",(e=>{DOM.modals.settings.customBoard.container.style.height=`${DOM.modals.settings.customBoard.container.scrollHeight}px`,"custom"==e.target.value?(DOM.modals.settings.customBoard.container.classList.add("open"),DOM.modals.settings.customBoard.container.addEventListener("transitionend",(()=>{DOM.modals.settings.customBoard.container.style.removeProperty("height")}),{once:!0})):(DOM.modals.settings.customBoard.container.classList.remove("open"),window.setTimeout((()=>{DOM.modals.settings.customBoard.container.style.removeProperty("height")})))}));const root=document.documentElement;DOM.modals.settings.tileSize.addEventListener("input",(e=>{settings.tileSize=e.target.value,root.style.setProperty("--tile-size",`${e.target.value}px`)})),DOM.modals.settings.theme.addEventListener("change",(e=>{switch(settings.theme=e.target.value,settings.theme){case"auto":root.classList.add("auto"),root.classList.remove("dark");break;case"light":root.classList.remove("auto"),root.classList.remove("dark");break;case"dark":root.classList.add("dark"),root.classList.remove("auto")}}));let tempSettings=localStorage.getItem("sweeperofmines-settings"),tempStats=localStorage.getItem("sweeperofmines-statistics");null!=tempSettings&&(settings=JSON.parse(tempSettings),DOM.modals.settings.boardSize.value=settings.boardSize,"custom"==settings.boardSize&&DOM.modals.settings.customBoard.container.classList.add("open"),DOM.modals.settings.customBoard.columns.value=settings.board.columns,DOM.modals.settings.customBoard.rows.value=settings.board.rows,DOM.modals.settings.customBoard.numOfMines.value=settings.board.numOfMines,DOM.modals.settings.customBoard.maxMines.value=settings.maxMines,DOM.modals.settings.tileSize.value=settings.tileSize,DOM.modals.settings.theme.value=settings.theme,DOM.modals.settings.theme.dispatchEvent(new Event("change")),root.style.setProperty("--tile-size",`${settings.tileSize}px`)),null!=tempStats&&(statistics=JSON.parse(tempStats));const urlParams=new URLSearchParams(window.location.search);let customBoardUnlimited=!1;urlParams.has("customBoardUnlimited")&&(customBoardUnlimited=!0);const allRanges=document.querySelectorAll(".range-wrap");function setBubble(e,a){const t=e.value,s=e.min?e.min:0,n=e.max?e.max:100,r=Number(100*(t-s)/(n-s));a.innerHTML=t,a.style.left=`calc(${r}% + (${10-.19*r}px))`}allRanges.forEach((e=>{const a=e.querySelector('[type="range"]'),t=e.querySelector(".bubble");a.addEventListener("input",(()=>{setBubble(a,t)})),setBubble(a,t)}));let xyzzyPassword="xyzzy",passwordPosition=0,xyzzyPixel=byId("xyzzypixel");function xyzzyInit(){DOM.playarea.board.tiles.forEach((e=>{e.addEventListener("pointerover",(()=>{gameVars.xyzzyShift&&(board[e.dataset.row][e.dataset.column].hasMine?xyzzyPixel.style.backgroundColor="#000":xyzzyPixel.style.backgroundColor="#FFF")}))}))}document.onkeydown=e=>{e.key==xyzzyPassword[passwordPosition]?passwordPosition++:passwordPosition=0,passwordPosition>=5&&(xyzzyInit(),gameVars.xyzzyActivated=!0,document.onkeydown=e=>{"Shift"==e.key&&(gameVars.xyzzyShift=!0)},document.onkeyup=e=>{"Shift"==e.key&&(gameVars.xyzzyShift=!1)})},newGame();