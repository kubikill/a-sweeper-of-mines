(()=>{var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},a={},n=e.parcelRequireecc7;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in a){var n=a[e];delete a[e];var s={id:e,exports:{}};return t[e]=s,n.call(s.exports,s,s.exports),s.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){a[e]=t},e.parcelRequireecc7=n),n.register("i3ZTK",(function(e,t){"use strict";function a(e){return document.getElementById(e)}const n={nav:{menuBtn:a("menu-btn"),settingsBtn:a("settings-btn"),newGameBtn:a("newgame-btn"),mineCounter:document.querySelector("#mine-counter > span"),timer:{minutes:a("timer-minutes"),seconds:a("timer-seconds")},hintBtn:a("hint-btn"),mineBtn:a("mine-btn"),markBtn:a("mark-btn")},playarea:{container:a("playarea"),columnNums:a("column-nums"),rowNums:a("row-nums"),board:{tiles:null,container:a("board")},winOverlay:{container:a("win-overlay"),time:a("win-time"),newBestTime:a("new-best-time"),newGameBtn:a("win-new-game-btn"),viewBoardBtn:a("win-view-board-btn")},loseOverlay:{container:a("lose-overlay"),minesLeft:a("lose-mines-left"),newGameBtn:a("lose-new-game-btn"),viewBoardBtn:a("lose-view-board-btn")}},modals:{container:a("modals"),menu:{container:a("menu-modal"),btns:a("menu-modal-btns")},settings:{container:a("settings-modal"),boardSize:a("settings-boardSize"),customBoard:{container:a("settings-customBoard"),rows:a("settings-boardHeight"),columns:a("settings-boardWidth"),numOfMines:a("settings-mineNum"),maxMines:a("settings-maxMines")},boardApplyWarning:a("settings-applywarning"),tileSize:a("settings-tileSize"),theme:a("settings-theme")},statistics:{select:a("stats-select"),gamesPlayed:a("stats-gamesplayed"),gamesWon:a("stats-gameswon"),gamesLost:a("stats-gameslost"),winPercent:a("stats-winpercent"),bestTime:a("stats-besttime"),longestWinningStreak:a("stats-longestwinstreak"),longestLosingStreak:a("stats-longestlosestreak"),currentStreak:a("stats-currentstreak")},newGameWarning:{container:a("newgamewarning-modal"),confirm:a("newgamewarning-confirm")}}};let s=[];class r{uncovered=!1;hasMine=!1;numOfNearbyMines=0;markedAsEmpty=!1}const i={state:"initial",minesLeft:20,hints:1,hintMode:!1,markMode:"none",clickSwap:!1,timeStart:null,board:{rows:10,columns:10,numOfMines:20},clockInterval:null,boardSize:"small",rowMineCount:[],columnMineCount:[]};let o={board:{rows:10,columns:10,numOfMines:20},boardSize:"small",maxMines:50,tileSize:32,theme:"auto"};const l={small:{rows:10,columns:10,numOfMines:20},medium:{rows:15,columns:15,numOfMines:50},large:{rows:20,columns:20,numOfMines:90},veryLarge:{rows:30,columns:30,numOfMines:200}};let d={small:{gamesWon:0,gamesLost:0,bestTime:null,longestWinningStreak:0,longestLosingStreak:0,currentStreak:0,streakMode:"N/A"},medium:{gamesWon:0,gamesLost:0,bestTime:null,longestWinningStreak:0,longestLosingStreak:0,currentStreak:0,streakMode:"N/A"},large:{gamesWon:0,gamesLost:0,bestTime:null,longestWinningStreak:0,longestLosingStreak:0,currentStreak:0,streakMode:"N/A"},veryLarge:{gamesWon:0,gamesLost:0,bestTime:null,longestWinningStreak:0,longestLosingStreak:0,currentStreak:0,streakMode:"N/A"},custom:{gamesWon:0,gamesLost:0,longestWinningStreak:0,longestLosingStreak:0,currentStreak:0,streakMode:"N/A"}};function c(e,t){return e<0||e>=i.board.rows||t<0||t>=i.board.columns||!s[e][t].hasMine?0:1}function m(e,t){let a=0;for(let n=-1;n<=1;n++)for(let s=-1;s<=1;s++)0==n&&0==s||(a+=c(e+n,t+s));s[e][t].numOfNearbyMines=a}function u(e,t){return n.playarea.board.container.querySelector(`[data-row="${e}"][data-column="${t}"]`)}function g(e,t){"initial"==i.state?(i.state="underway",function(e,t,a){let n=[];for(let e=0;e<i.board.rows;e++)for(let t=0;t<i.board.columns;t++)n.push({row:e,column:t});i.rowMineCount=new Array(i.board.rows).fill(0),i.columnMineCount=new Array(i.board.columns).fill(0);let r=n.findIndex((a=>a.row==e&&a.column==t));-1!=r&&n.splice(r,1),s[e][t].hasMine=!0;for(let e=1;e<a;e++){let e=Math.floor(Math.random()*n.length);s[n[e].row][n[e].column].hasMine=!0,n.splice(e,1)}for(let e=0;e<s.length;e++)for(let t=0;t<s[e].length;t++)m(parseInt(e),parseInt(t)),s[e][t].hasMine&&(i.rowMineCount[e]++,i.columnMineCount[t]++)}(e,t,i.board.numOfMines),function(){let e="";for(let t of i.rowMineCount)e+=`<div>${t}</div>`;n.playarea.rowNums.innerHTML=e,e="";for(let t of i.columnMineCount)e+=`<div>${t}</div>`;n.playarea.columnNums.innerHTML=e}(),i.clockInterval=setInterval((()=>{let e=Date.now()-i.timeStart,t=Math.floor(e/1e3),a=Math.floor(t/60),s=t%60;n.nav.timer.minutes.innerHTML=a<=9?`0${a}`:a,n.nav.timer.seconds.innerHTML=s<=9?`0${s}`:s}),200),i.timeStart=Date.now(),y(e,t),n.nav.mineCounter.innerHTML=i.minesLeft,i.xyzzyActivated&&I()):"underway"==i.state&&(1==i.hintMode?(y(e,t,!0),i.hints-=1,n.nav.hintBtn.dataset.hints=i.hints,i.hints<=0&&(n.nav.hintBtn.classList.remove("hint-active"),n.nav.hintBtn.classList.add("hint-disabled"),i.hintMode=!1)):y(e,t),n.nav.mineCounter.innerHTML=i.minesLeft)}function v(e,t){"underway"!=i.state||s[e][t].uncovered||(s[e][t].markedAsEmpty?("none"==i.markMode&&(i.markMode="remove"),"remove"==i.markMode&&(s[e][t].markedAsEmpty=!1,u(e,t).innerHTML="")):("none"==i.markMode&&(i.markMode="mark"),"mark"==i.markMode&&(s[e][t].markedAsEmpty=!0,u(e,t).innerHTML='<i class="icon-flag"></i>')))}function y(e,t,a=!1,r=!1){if("underway"!=i.state&&!r||e<0||e>=i.board.rows||t<0||t>=i.board.columns||s[e][t].uncovered)return null;if(s[e][t].hasMine&&!s[e][t].markedAsEmpty){u(e,t).innerHTML="<i class='icon-mine'></i>",u(e,t).dataset.clickable="false",s[e][t].uncovered=!0;for(let a=-1;a<=1;a++)for(let n=-1;n<=1;n++)0==a&&0==n||y(e+a,t+n,!0,r);i.minesLeft--,0==i.minesLeft&&"underway"==i.state&&function(){let e=Date.now()-i.timeStart,t=Math.floor(e/1e3),a=Math.floor(t/60),s=t%60,r=e%1e3;a<=9&&(a=`0${a}`);s<=9&&(s=`0${s}`);r<=100&&(r=`${"0".repeat(3-r.toString().length)}${r}`);n.playarea.winOverlay.time.innerHTML=`${a}:${s}.${r}`,d[i.boardSize].gamesWon++,"winning"!=d[i.boardSize].streakMode?(d[i.boardSize].currentStreak=1,d[i.boardSize].streakMode="winning"):d[i.boardSize].currentStreak++;d[i.boardSize].currentStreak>d[i.boardSize].longestWinningStreak&&(d[i.boardSize].longestWinningStreak=d[i.boardSize].currentStreak);e<=d[i.boardSize].bestTime||null===d[i.boardSize].bestTime?(d[i.boardSize].bestTime=e,n.playarea.winOverlay.newBestTime.style.display="block"):n.playarea.winOverlay.newBestTime.style.display="NONE";localStorage.setItem("sweeperofmines-statistics",JSON.stringify(d)),n.playarea.winOverlay.container.classList.remove("fade"),n.playarea.winOverlay.container.classList.add("visible"),n.playarea.board.container.classList.add("no-input"),i.state="finished",clearInterval(i.clockInterval)}()}else a?(s[e][t].uncovered=!0,s[e][t].markedAsEmpty=!1,u(e,t).innerHTML=s[e][t].numOfNearbyMines,u(e,t).dataset.clickable="false"):s[e][t].markedAsEmpty||"underway"!=i.state||(u(e,t).classList.add("wrong-tile"),function(){d[i.boardSize].gamesLost++,"losing"!=d[i.boardSize].streakMode?(d[i.boardSize].currentStreak=1,d[i.boardSize].streakMode="losing"):d[i.boardSize].currentStreak++;d[i.boardSize].currentStreak>d[i.boardSize].longestLosingStreak&&(d[i.boardSize].longestLosingStreak=d[i.boardSize].currentStreak);localStorage.setItem("sweeperofmines-statistics",JSON.stringify(d)),n.playarea.loseOverlay.minesLeft.innerHTML=i.minesLeft,n.playarea.loseOverlay.container.classList.remove("fade"),n.playarea.loseOverlay.container.classList.add("visible"),n.playarea.board.container.classList.add("no-input"),i.state="finished",clearInterval(i.clockInterval)}())}function b(e){if(n.modals.statistics.gamesPlayed.innerHTML=d[e].gamesWon+d[e].gamesLost,n.modals.statistics.gamesWon.innerHTML=d[e].gamesWon,n.modals.statistics.gamesLost.innerHTML=d[e].gamesLost,d[e].gamesWon+d[e].gamesLost!=0){let t=d[e].gamesWon/(d[e].gamesWon+d[e].gamesLost)*100;n.modals.statistics.winPercent.innerHTML=`${t.toFixed(2)}%`}else n.modals.statistics.winPercent.innerHTML="N/A";if(n.modals.statistics.longestWinningStreak.innerHTML=d[e].longestWinningStreak,n.modals.statistics.longestLosingStreak.innerHTML=d[e].longestLosingStreak,n.modals.statistics.currentStreak.innerHTML=`${d[e].currentStreak} (${d[e].streakMode})`,"custom"!=e){if(null!=d[e].bestTime){let t=Math.floor(d[e].bestTime/1e3/60),a=Math.floor(d[e].bestTime/1e3%60),s=d[e].bestTime%1e3;n.modals.statistics.bestTime.innerHTML=`${t}:${a}.${s}`}else n.modals.statistics.bestTime.innerHTML="N/A";n.modals.statistics.bestTime.parentNode.style.removeProperty("display")}else n.modals.statistics.bestTime.parentNode.style.display="none"}let p=!1,f=!1;function L(){i.boardSize=o.boardSize,"custom"!=o.boardSize?Object.assign(i.board,l[i.boardSize]):Object.assign(i.board,o.board),n.modals.settings.boardApplyWarning.style.removeProperty("display"),i.hints=1+Math.floor(i.board.columns*i.board.rows/400),i.hintMode=!1,n.nav.hintBtn.dataset.hints=i.hints,n.nav.hintBtn.classList.remove("hint-active"),n.nav.hintBtn.classList.remove("hint-disabled"),function(){s=[];for(let e=0;e<i.board.rows;e++){s[e]=[];for(let t=0;t<i.board.columns;t++)s[e][t]=new r}}(),function(){let e="";for(let t=0;t<s.length;t++){e+="<div>";for(let a=0;a<s[t].length;a++)e+=`<div data-row="${t}" data-column="${a}"></div>`;e+="</div>"}n.playarea.board.container.innerHTML=e,n.playarea.board.tiles=document.querySelectorAll("[data-row][data-column]");for(let e of n.playarea.board.tiles)e.addEventListener("pointerdown",(t=>{t.isPrimary&&!p?((2==t.button||i.clickSwap)&&(f=!0,v(parseInt(e.dataset.row),parseInt(e.dataset.column))),t.target.releasePointerCapture(t.pointerId)):p=!0})),e.addEventListener("pointerup",(t=>{t.isPrimary&&(t.isPrimary&&p?p=!1:(f=!1,i.clickSwap||0!=t.button||g(parseInt(e.dataset.row),parseInt(e.dataset.column))))})),e.addEventListener("pointerenter",(t=>{t.isPrimary&&(f||2==t.buttons)&&v(parseInt(e.dataset.row),parseInt(e.dataset.column))})),e.addEventListener("pointercancel",(e=>{f=!1,i.markMode="none"}))}(),function(){let e="";for(let t=0;t<i.board.rows;t++)e+="<div>#</div>";n.playarea.rowNums.innerHTML=e,e="";for(let t=0;t<i.board.columns;t++)e+="<div>#</div>";n.playarea.columnNums.innerHTML=e}(),i.state="initial",clearInterval(i.clockInterval),n.nav.timer.minutes.innerHTML=n.nav.timer.seconds.innerHTML="00",n.playarea.board.container.classList.remove("no-input"),n.nav.mineCounter.innerHTML=i.minesLeft=i.board.numOfMines}document.body.addEventListener("pointerup",(()=>{f=!1,i.markMode="none"})),n.nav.mineBtn.addEventListener("click",(()=>{i.clickSwap=!1,n.playarea.board.container.classList.remove("no-scroll"),n.nav.mineBtn.classList.add("active"),n.nav.markBtn.classList.remove("active")})),n.nav.markBtn.addEventListener("click",(()=>{i.clickSwap=!0,n.playarea.board.container.classList.add("no-scroll"),n.nav.markBtn.classList.add("active"),n.nav.mineBtn.classList.remove("active")})),n.nav.newGameBtn.addEventListener("click",(e=>{"underway"===i.state?(n.modals.container.classList.add("visible"),n.modals.container.classList.remove("fade"),n.modals.newGameWarning.container.classList.add("visible"),n.modals.newGameWarning.container.classList.remove("fade")):L()})),n.modals.newGameWarning.confirm.addEventListener("click",(e=>{d[i.boardSize].gamesLost++,"losing"!=d[i.boardSize].streakMode?(d[i.boardSize].currentStreak=1,d[i.boardSize].streakMode="losing"):d[i.boardSize].currentStreak++,d[i.boardSize].currentStreak>d[i.boardSize].longestLosingStreak&&(d[i.boardSize].longestLosingStreak=d[i.boardSize].currentStreak),localStorage.setItem("sweeperofmines-statistics",JSON.stringify(d)),L()})),n.nav.hintBtn.addEventListener("click",(()=>{i.hints>=1&&(n.nav.hintBtn.classList.toggle("hint-active"),i.hintMode=!i.hintMode)})),document.querySelectorAll("[data-modalopen]").forEach((e=>{e.addEventListener("click",(()=>{n.modals.container.classList.add("visible"),n.modals.container.classList.remove("fade"),document.querySelector(e.dataset.modalopen).classList.add("visible"),document.querySelector(e.dataset.modalopen).classList.remove("fade")}))})),document.querySelectorAll(".modal-close").forEach((e=>{e.addEventListener("click",(()=>{n.modals.container.classList.add("fade"),n.modals.container.classList.remove("visible"),e.parentNode.parentNode.classList.add("fade"),e.parentNode.parentNode.classList.remove("visible")}))})),document.querySelectorAll('[data-modalopen="#statistics-modal"]').forEach((e=>{e.addEventListener("click",(()=>{b(n.modals.statistics.select.value)}))})),n.modals.settings.container.addEventListener("click",(()=>{localStorage.setItem("sweeperofmines-settings",JSON.stringify(o)),"underway"!=i.state&&L()})),n.modals.settings.container.querySelector(".modal-close").addEventListener("click",(()=>{localStorage.setItem("sweeperofmines-settings",JSON.stringify(o)),"underway"!=i.state&&L()})),document.querySelectorAll(".modal").forEach((e=>{e.addEventListener("click",(t=>{t.target===t.currentTarget&&(n.modals.settings.container.classList.contains("visible")&&localStorage.setItem("sweeperofmines-settings",JSON.stringify(o)),n.modals.container.classList.add("fade"),n.modals.container.classList.remove("visible"),e.classList.add("fade"),e.classList.remove("visible"))}))})),n.modals.settings.container.addEventListener("click",(()=>{"underway"!=i.state&&L()})),n.modals.menu.btns.querySelectorAll("button").forEach((e=>{e.addEventListener("click",(()=>{n.modals.menu.container.classList.add("fade"),n.modals.menu.container.classList.remove("visible")}))})),n.playarea.container.addEventListener("contextmenu",(e=>(e.preventDefault(),!1))),n.playarea.board.container.addEventListener("scroll",(()=>{n.playarea.rowNums.scroll(0,n.playarea.board.container.scrollTop),n.playarea.columnNums.scroll(n.playarea.board.container.scrollLeft,0)}),{passive:!0}),n.playarea.winOverlay.newGameBtn.addEventListener("click",(()=>{L(),n.playarea.winOverlay.container.classList.add("fade"),n.playarea.winOverlay.container.classList.remove("visible")})),n.playarea.winOverlay.viewBoardBtn.addEventListener("click",(()=>{n.playarea.winOverlay.container.classList.add("fade"),n.playarea.winOverlay.container.classList.remove("visible")})),n.playarea.loseOverlay.newGameBtn.addEventListener("click",(()=>{L(),n.playarea.loseOverlay.container.classList.add("fade"),n.playarea.loseOverlay.container.classList.remove("visible")})),n.playarea.loseOverlay.viewBoardBtn.addEventListener("click",(()=>{n.playarea.loseOverlay.container.classList.add("fade"),n.playarea.loseOverlay.container.classList.remove("visible"),function(){for(let e=0;e<s.length;e++)for(let t=0;t<s[e].length;t++)s[e][t].hasMine?(u(e,t).innerHTML="<i class='icon-mine'></i>",u(e,t).dataset.clickable="false"):u(e,t).innerHTML=s[e][t].numOfNearbyMines}()})),n.modals.settings.boardSize.addEventListener("change",(e=>{o.boardSize=e.target.value,"underway"==i.state&&(n.modals.settings.boardApplyWarning.style.display="block")}));const w=/^[0-9]+$/g;function S(){let e=Math.floor(o.board.columns*o.board.rows/2);e<12&&(e=12),n.modals.settings.customBoard.maxMines.innerHTML=o.maxMines=e,n.modals.settings.customBoard.numOfMines.value>o.maxMines&&(n.modals.settings.customBoard.numOfMines.value=o.maxMines),o.board.numOfMines=parseInt(n.modals.settings.customBoard.numOfMines.value)}n.modals.settings.customBoard.columns.addEventListener("input",(e=>{e.target.value=e.target.value.match(w),e.target.value?e.target.value>100&&!B?(e.target.value=100,o.board.columns=parseInt(e.target.value)):o.board.columns=parseInt(e.target.value):o.board.columns=5,S(),"underway"==i.state&&(n.modals.settings.boardApplyWarning.style.display="block")})),n.modals.settings.customBoard.columns.addEventListener("blur",(e=>{!e.target.value||e.target.value<5?e.target.value=5:e.target.value>100&&!B&&(e.target.value=100),o.board.columns=parseInt(e.target.value),S(),"underway"==i.state&&(n.modals.settings.boardApplyWarning.style.display="block")})),n.modals.settings.customBoard.rows.addEventListener("input",(e=>{e.target.value=e.target.value.match(w),""==e.target.value?o.board.rows=5:e.target.value>100&&!B?(e.target.value=100,o.board.rows=parseInt(e.target.value)):o.board.rows=parseInt(e.target.value),S(),"underway"==i.state&&(n.modals.settings.boardApplyWarning.style.display="block")})),n.modals.settings.customBoard.rows.addEventListener("blur",(e=>{""==e.target.value||e.target.value<5?e.target.value=5:e.target.value>100&&!B&&(e.target.value=100),o.board.rows=parseInt(e.target.value),S(),"underway"==i.state&&(n.modals.settings.boardApplyWarning.style.display="block")})),n.modals.settings.customBoard.numOfMines.addEventListener("input",(e=>{e.target.value>o.maxMines&&(e.target.value=o.maxMines),o.board.numOfMines=parseInt(e.target.value),"underway"==i.state?n.modals.settings.boardApplyWarning.style.display="block":i.board.numOfMines=parseInt(e.target.value)})),n.modals.settings.customBoard.numOfMines.addEventListener("blur",(e=>{(e.target.value<2||!e.target.value)&&(e.target.value=2),o.board.numOfMines=parseInt(e.target.value),"underway"==i.state?n.modals.settings.boardApplyWarning.style.display="block":i.board.numOfMines=parseInt(e.target.value)})),n.modals.statistics.select.addEventListener("change",(e=>{b(e.target.value)})),n.modals.settings.boardSize.addEventListener("change",(e=>{n.modals.settings.customBoard.container.style.height=`${n.modals.settings.customBoard.container.scrollHeight}px`,"custom"==e.target.value?(n.modals.settings.customBoard.container.classList.add("open"),n.modals.settings.customBoard.container.addEventListener("transitionend",(()=>{n.modals.settings.customBoard.container.style.removeProperty("height")}),{once:!0})):(n.modals.settings.customBoard.container.classList.remove("open"),window.setTimeout((()=>{n.modals.settings.customBoard.container.style.removeProperty("height")})))}));const k=document.documentElement;n.modals.settings.tileSize.addEventListener("input",(e=>{o.tileSize=e.target.value,k.style.setProperty("--tile-size",`${e.target.value}px`)})),n.modals.settings.theme.addEventListener("change",(e=>{switch(o.theme=e.target.value,o.theme){case"auto":k.classList.add("auto"),k.classList.remove("dark");break;case"light":k.classList.remove("auto"),k.classList.remove("dark");break;case"dark":k.classList.add("dark"),k.classList.remove("auto")}}));let M=localStorage.getItem("sweeperofmines-settings"),h=localStorage.getItem("sweeperofmines-statistics");null!=M&&(o=JSON.parse(M),n.modals.settings.boardSize.value=o.boardSize,"custom"==o.boardSize&&n.modals.settings.customBoard.container.classList.add("open"),n.modals.settings.customBoard.columns.value=o.board.columns,n.modals.settings.customBoard.rows.value=o.board.rows,n.modals.settings.customBoard.numOfMines.value=o.board.numOfMines,n.modals.settings.customBoard.maxMines.value=o.maxMines,n.modals.settings.tileSize.value=o.tileSize,n.modals.settings.theme.value=o.theme,n.modals.settings.theme.dispatchEvent(new Event("change")),k.style.setProperty("--tile-size",`${o.tileSize}px`)),null!=h&&(d=JSON.parse(h));const z=new URLSearchParams(window.location.search);let B=!1;z.has("customBoardUnlimited")&&(B=!0);function O(e,t){const a=e.value,n=e.min?e.min:0,s=e.max?e.max:100,r=Number(100*(a-n)/(s-n));t.innerHTML=a,t.style.left=`calc(${r}% + (${10-.19*r}px))`}document.querySelectorAll(".range-wrap").forEach((e=>{const t=e.querySelector('[type="range"]'),a=e.querySelector(".bubble");t.addEventListener("input",(()=>{O(t,a)})),O(t,a)}));let E=0,T=a("xyzzypixel");function I(){n.playarea.board.tiles.forEach((e=>{e.addEventListener("pointerover",(()=>{i.xyzzyShift&&(s[e.dataset.row][e.dataset.column].hasMine?T.style.backgroundColor="#000":T.style.backgroundColor="#FFF")}))}))}document.onkeydown=e=>{e.key=="xyzzy"[E]?E++:E=0,E>=5&&(I(),i.xyzzyActivated=!0,document.onkeydown=e=>{"Shift"==e.key&&(i.xyzzyShift=!0)},document.onkeyup=e=>{"Shift"==e.key&&(i.xyzzyShift=!1)})},L()})),n("i3ZTK")})();