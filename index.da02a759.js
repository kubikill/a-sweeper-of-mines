!function(){"use strict";function e(e,a){return e<0||e>=settings.board.rows||a<0||a>=settings.board.columns||!board[e][a].hasMine?0:1}function a(a,n){let r=0;for(let t=-1;t<=1;t++)for(let s=-1;s<=1;s++)0==t&&0==s||(r+=e(a+t,n+s));board[a][n].numOfNearbyMines=r}function n(e,n){"initial"==gameVars.state?(gameVars.state="underway",function(e,n,r){let t=[];for(let e=0;e<settings.board.rows;e++)for(let a=0;a<settings.board.columns;a++)t.push({row:e,column:a});gameVars.rowMineCount=new Array(settings.board.rows).fill(0),gameVars.columnMineCount=new Array(settings.board.columns).fill(0);let s=t.findIndex((a=>a.row==e&&a.column==n));-1!=s&&t.splice(s,1),board[e][n].hasMine=!0;for(let e=1;e<r;e++){let e=Math.floor(Math.random()*t.length);board[t[e].row][t[e].column].hasMine=!0,t.splice(e,1)}for(let e in board)for(let n in board[e])a(parseInt(e),parseInt(n)),board[e][n].hasMine&&(gameVars.rowMineCount[e]++,gameVars.columnMineCount[n]++)}(e,n,settings.board.numOfMines),function(){let e="";for(let a of gameVars.rowMineCount)e+=`<div>${a}</div>`;DOM.playarea.rowNums.innerHTML=e,e="";for(let a of gameVars.columnMineCount)e+=`<div>${a}</div>`;DOM.playarea.columnNums.innerHTML=e}(),s(e,n),DOM.nav.mineCounter.innerHTML=gameVars.minesLeft,clockInterval=setInterval(i,1e3),gameVars.xyzzyActivated&&xyzzyInit()):"underway"==gameVars.state&&(s(e,n),DOM.nav.mineCounter.innerHTML=gameVars.minesLeft)}function r(e,a){"underway"!=gameVars.state||board[e][a].uncovered||(board[e][a].markedAsEmpty=!board[e][a].markedAsEmpty,board[e][a].markedAsEmpty?t(e,a).innerHTML="X":t(e,a).innerHTML="")}function t(e,a){return DOM.playarea.board.container.querySelector(`[data-row="${e}"][data-column="${a}"]`)}function s(e,a,n=!1,r=!1){if("underway"!=gameVars.state&&!r||e<0||e>=settings.board.rows||a<0||a>=settings.board.columns||board[e][a].uncovered)return null;if(board[e][a].hasMine&&!board[e][a].markedAsEmpty){t(e,a).innerHTML="<i class='icon-mine'></i>",t(e,a).dataset.clickable="false",board[e][a].uncovered=!0;for(let n=-1;n<=1;n++)for(let t=-1;t<=1;t++)0==n&&0==t||s(e+n,a+t,!0,r);gameVars.minesLeft--,0==gameVars.minesLeft&&"underway"==gameVars.state&&(DOM.playarea.winOverlay.container.classList.remove("fade"),DOM.playarea.winOverlay.container.classList.add("visible"),DOM.playarea.board.container.classList.add("no-input"),gameVars.state="finished",clearInterval(clockInterval))}else n?(board[e][a].uncovered=!0,board[e][a].markedAsEmpty=!1,t(e,a).innerHTML=board[e][a].numOfNearbyMines,t(e,a).dataset.clickable="false"):board[e][a].markedAsEmpty||"underway"!=gameVars.state||(t(e,a).classList.add("wrong-tile"),DOM.playarea.loseOverlay.container.classList.remove("fade"),DOM.playarea.loseOverlay.container.classList.add("visible"),DOM.playarea.board.container.classList.add("no-input"),gameVars.state="finished",clearInterval(clockInterval))}function i(){gameVars.time.seconds++,gameVars.time.seconds>=60&&(gameVars.time.seconds-=60,gameVars.time.minutes++),gameVars.time.minutes<=9?DOM.nav.timer.minutes.innerHTML=`0${gameVars.time.minutes}`:DOM.nav.timer.minutes.innerHTML=gameVars.time.minutes,gameVars.time.seconds<=9?DOM.nav.timer.seconds.innerHTML=`0${gameVars.time.seconds}`:DOM.nav.timer.seconds.innerHTML=gameVars.time.seconds}function o(){!function(){board=[];for(let e=0;e<settings.board.rows;e++){board[e]=[];for(let a=0;a<settings.board.columns;a++)board[e][a]=new Tile}}(),function(){let e="";for(let a in board){e+="<div>";for(let n in board[a])e+=`<div data-row="${a}" data-column="${n}"></div>`;e+="</div>"}DOM.playarea.board.container.innerHTML=e,DOM.playarea.board.tiles=document.querySelectorAll("[data-row][data-column]");for(let e of DOM.playarea.board.tiles)e.addEventListener("mousedown",(a=>{switch(a.which){case 1:n(parseInt(e.dataset.row),parseInt(e.dataset.column));break;case 3:r(parseInt(e.dataset.row),parseInt(e.dataset.column))}})),e.addEventListener("contextmenu",(e=>(e.preventDefault(),!1))),e.addEventListener("mouseenter",(a=>{3==a.which&&r(parseInt(e.dataset.row),parseInt(e.dataset.column))}))}(),function(){let e="";for(let a=0;a<settings.board.rows;a++)e+="<div>#</div>";DOM.playarea.rowNums.innerHTML=e,e="";for(let a=0;a<settings.board.columns;a++)e+="<div>#</div>";DOM.playarea.columnNums.innerHTML=e}(),gameVars.state="initial",clearInterval(clockInterval),gameVars.time.minutes=0,gameVars.time.seconds=0,DOM.nav.timer.minutes.innerHTML="00",DOM.nav.timer.seconds.innerHTML="00",DOM.playarea.board.container.classList.remove("no-input"),DOM.nav.mineCounter.innerHTML=gameVars.minesLeft=settings.board.numOfMines}DOM.nav.newGameBtn.addEventListener("click",(()=>{o()})),document.querySelectorAll("[data-modalopen]").forEach((e=>{e.addEventListener("click",(()=>{DOM.modals.container.classList.add("visible"),DOM.modals.container.classList.remove("fade"),document.querySelector(e.dataset.modalopen).classList.add("visible"),document.querySelector(e.dataset.modalopen).classList.remove("fade")}))})),document.querySelectorAll(".modal-close").forEach((e=>{e.addEventListener("click",(()=>{DOM.modals.container.classList.add("fade"),DOM.modals.container.classList.remove("visible"),e.parentNode.parentNode.classList.add("fade"),e.parentNode.parentNode.classList.remove("visible")}))})),document.querySelectorAll(".modal").forEach((e=>{e.addEventListener("click",(a=>{a.target===a.currentTarget&&(DOM.modals.container.classList.add("fade"),DOM.modals.container.classList.remove("visible"),e.classList.add("fade"),e.classList.remove("visible"))}))})),DOM.modals.menu.btns.querySelectorAll("button").forEach((e=>{e.addEventListener("click",(()=>{DOM.modals.menu.container.classList.add("fade"),DOM.modals.menu.container.classList.remove("visible")}))})),DOM.playarea.winOverlay.newGameBtn.addEventListener("click",(()=>{o(),DOM.playarea.winOverlay.container.classList.add("fade"),DOM.playarea.winOverlay.container.classList.remove("visible")})),DOM.playarea.winOverlay.viewBoardBtn.addEventListener("click",(()=>{DOM.playarea.winOverlay.container.classList.add("fade"),DOM.playarea.winOverlay.container.classList.remove("visible")})),DOM.playarea.loseOverlay.newGameBtn.addEventListener("click",(()=>{o(),DOM.playarea.loseOverlay.container.classList.add("fade"),DOM.playarea.loseOverlay.container.classList.remove("visible")})),DOM.playarea.loseOverlay.viewBoardBtn.addEventListener("click",(()=>{DOM.playarea.loseOverlay.container.classList.add("fade"),DOM.playarea.loseOverlay.container.classList.remove("visible"),function(){for(let e in board)for(let a in board[e])board[e][a].hasMine&&!board[e][a].uncovered?(board[e][a].markedAsEmpty=!1,s(parseInt(e),parseInt(a),!1,!0)):board[e][a].hasMine||0!=board[e][a].numOfNearbyMines||(t(e,a).innerHTML="#")}()})),o()}();
//# sourceMappingURL=index.da02a759.js.map
